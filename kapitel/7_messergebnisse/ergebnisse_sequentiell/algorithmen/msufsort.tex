\subsubsection{mSufSort}

\textbf{Configuration} \hfill Model name: none
% IMPORT-DATA stats2 ../results.txt

\begin{figure}[ht]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
                name=axis1,
                cycle list name={exoticlines},
                width=0.5\textwidth,
                height=65mm,
                title={wiki.txt},
                xlabel={input size [200\,MB]},
                ylabel={SA construction time [min]},
                legend columns=2,
                legend to name=legend-seq-msufsort-0,
                legend style={
                    /tikz/every even column/.append style={column sep=0.5cm,black},
                    /tikz/every even column/.append style={black},
                },
            ]

            %% MULTIPLOT(algo) SELECT thread_count AS x, time/1000/60 AS y, MULTIPLOT
            %% FROM (
            %% SELECT algo, input, MEDIAN(memFinal) AS memFinal, MEDIAN(memOff) AS memOff, AVG(memPeak) AS memPeak, prefix, rep, thread_count, MEDIAN(time) AS time, sacheck FROM stats2 GROUP BY algo, input, prefix, rep, thread_count
            %% ) WHERE input="wiki.txt" AND sacheck="ok" 
            %% AND (algo="Naiv" OR algo="MSufSort_ref" OR algo="mSufSort" OR algo="mSufSort_scan" OR algo="mSufSortV2")
            %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
            \addplot coordinates { (1,0.784501) (2,1.67667) (4,3.62553) };
            \addlegendentry{algo=MSufSort\_ref};
            \addplot coordinates { (1,2.71401) (2,6.02671) (4,13.0504) (8,28.824) (12,57.4765) (16,64.0376) (20,103.051) };
            \addlegendentry{algo=Naiv};
            \addplot coordinates { (1,1.93949) (2,4.33888) (4,9.56014) (8,21.9244) (12,43.5735) (16,86.844) (20,82.7441) };
            \addlegendentry{algo=mSufSort};
            \addplot coordinates { (1,1.95476) (2,4.30389) (4,9.64036) (8,22.0904) (12,43.7356) (16,60.7898) (20,83.113) };
            \addlegendentry{algo=mSufSortV2};
            \addplot coordinates { (1,1.54531) (2,3.27118) (4,7.12055) (8,16.1895) (12,29.3221) (16,40.5633) (20,72.8995) };
            \addlegendentry{algo=mSufSort\_scan};

        \end{axis}
        \begin{axis}[
                cycle list name={exoticlines},
                at={(axis1.outer north east)},
                anchor=outer north west,
                name=axis2,
                width=0.5\textwidth,
                height=65mm,
                title={wiki.txt},
                xlabel={input size [200\,MB]},
                ylabel={Extra Memory [GiB]},
            ]

            %% MULTIPLOT(algo) SELECT thread_count AS x, memPeak/1024/1024/1024 AS y, MULTIPLOT
            %% FROM (
            %% SELECT algo, input, MEDIAN(memFinal) AS memFinal, MEDIAN(memOff) AS memOff, AVG(memPeak) AS memPeak, prefix, rep, thread_count, MEDIAN(time) AS time, sacheck FROM stats2 GROUP BY algo, input, prefix, rep, thread_count
            %% ) WHERE input="wiki.txt" AND sacheck="ok" 
            %% AND (algo="Naiv" OR algo="MSufSort_ref" OR algo="mSufSort" OR algo="mSufSort_scan" OR algo="mSufSortV2")
            %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
            \addplot coordinates { (1,0.791069) (2,1.58811) (4,3.22572) };
            \addlegendentry{algo=MSufSort\_ref};
            \addplot coordinates { (1,0.0) (2,0.0) (4,0.0) (8,0.0) (12,0.0) (16,0.0) (20,0.0) };
            \addlegendentry{algo=Naiv};
            \addplot coordinates { (1,0.217544) (2,0.434778) (4,0.87032) (8,1.75387) (12,6.3341) (16,7.10395) (20,7.86432) };
            \addlegendentry{algo=mSufSort};
            \addplot coordinates { (1,0.217544) (2,0.434779) (4,0.870323) (8,1.75388) (12,6.33412) (16,7.10398) (20,7.86435) };
            \addlegendentry{algo=mSufSortV2};
            \addplot coordinates { (1,0.0237676) (2,0.0472056) (4,0.0940837) (8,0.187833) (12,0.750667) (16,0.750667) (20,0.750676) };
            \addlegendentry{algo=mSufSort\_scan};

            \legend{}
        \end{axis}
    \end{tikzpicture}

    \medskip
    \ref{legend-seq-msufsort-0}
\end{figure}

\begin{figure}[ht]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
                name=axis1,
                cycle list name={exoticlines},
                width=0.5\textwidth,
                height=65mm,
                title={dna.txt},
                xlabel={input size [200\,MB]},
                ylabel={SA construction time [min]},
                legend columns=2,
                legend to name=legend-seq-msufsort-1,
                legend style={
                    /tikz/every even column/.append style={column sep=0.5cm,black},
                    /tikz/every even column/.append style={black},
                },
            ]

            %% MULTIPLOT(algo) SELECT thread_count AS x, time/1000/60 AS y, MULTIPLOT
            %% FROM (
            %% SELECT algo, input, MEDIAN(memFinal) AS memFinal, MEDIAN(memOff) AS memOff, AVG(memPeak) AS memPeak, prefix, rep, thread_count, MEDIAN(time) AS time, sacheck FROM stats2 GROUP BY algo, input, prefix, rep, thread_count
            %% ) WHERE input="dna.txt" AND sacheck="ok" 
            %% AND (algo="Naiv" OR algo="MSufSort_ref" OR algo="mSufSort" OR algo="mSufSort_scan" OR algo="mSufSortV2")
            %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
            \addplot coordinates { (1,0.991353) (2,2.06159) (4,4.35949) };
            \addlegendentry{algo=MSufSort\_ref};
            \addplot coordinates { (1,3.06579) (2,6.92353) (4,15.1789) (8,31.8439) (12,60.7547) (16,67.6962) (20,109.595) };
            \addlegendentry{algo=Naiv};
            \addplot coordinates { (1,2.25017) (2,4.88589) (4,10.7595) (8,23.2333) (12,66.3982) (16,91.0674) (20,112.214) };
            \addlegendentry{algo=mSufSort};
            \addplot coordinates { (1,2.25483) (2,4.93004) (4,10.7753) (8,23.1472) (12,46.3424) (16,63.6865) (20,112.524) };
            \addlegendentry{algo=mSufSortV2};
            \addplot coordinates { (1,1.45365) (2,3.11909) (4,6.73788) (8,14.489) (12,27.2236) (16,37.5013) (20,69.1651) };
            \addlegendentry{algo=mSufSort\_scan};

        \end{axis}
        \begin{axis}[
                cycle list name={exoticlines},
                at={(axis1.outer north east)},
                anchor=outer north west,
                name=axis2,
                width=0.5\textwidth,
                height=65mm,
                title={dna.txt},
                xlabel={input size [200\,MB]},
                ylabel={Extra Memory [GiB]},
            ]

            %% MULTIPLOT(algo) SELECT thread_count AS x, memPeak/1024/1024/1024 AS y, MULTIPLOT
            %% FROM (
            %% SELECT algo, input, MEDIAN(memFinal) AS memFinal, MEDIAN(memOff) AS memOff, AVG(memPeak) AS memPeak, prefix, rep, thread_count, MEDIAN(time) AS time, sacheck FROM stats2 GROUP BY algo, input, prefix, rep, thread_count
            %% ) WHERE input="dna.txt" AND sacheck="ok" 
            %% AND (algo="Naiv" OR algo="MSufSort_ref" OR algo="mSufSort" OR algo="mSufSort_scan" OR algo="mSufSortV2")
            %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
            \addplot coordinates { (1,0.981613) (2,1.96313) (4,3.92618) };
            \addlegendentry{algo=MSufSort\_ref};
            \addplot coordinates { (1,0.0) (2,0.0) (4,0.0) (8,0.0) (12,0.0) (16,0.0) (20,0.0) };
            \addlegendentry{algo=Naiv};
            \addplot coordinates { (1,0.4704) (2,0.875001) (4,1.75) (8,3.5) (12,12.6519) (16,14.2148) (20,15.719) };
            \addlegendentry{algo=mSufSort};
            \addplot coordinates { (1,0.4704) (2,0.882813) (4,1.76563) (8,3.51563) (12,12.6519) (16,14.2148) (20,15.719) };
            \addlegendentry{algo=mSufSortV2};
            \addplot coordinates { (1,0.0937508) (2,0.375001) (4,0.750001) (8,1.5) (12,3) (16,3) (20,6) };
            \addlegendentry{algo=mSufSort\_scan};

            \legend{}
        \end{axis}
    \end{tikzpicture}

    \medskip
    \ref{legend-seq-msufsort-1}
\end{figure}

\begin{figure}[ht]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
                name=axis1,
                cycle list name={exoticlines},
                width=0.5\textwidth,
                height=65mm,
                title={commoncrawl.txt},
                xlabel={input size [200\,MB]},
                ylabel={SA construction time [min]},
                legend columns=2,
                legend to name=legend-seq-msufsort-2,
                legend style={
                    /tikz/every even column/.append style={column sep=0.5cm,black},
                    /tikz/every even column/.append style={black},
                },
            ]

            %% MULTIPLOT(algo) SELECT thread_count AS x, time/1000/60 AS y, MULTIPLOT
            %% FROM (
            %% SELECT algo, input, MEDIAN(memFinal) AS memFinal, MEDIAN(memOff) AS memOff, AVG(memPeak) AS memPeak, prefix, rep, thread_count, MEDIAN(time) AS time, sacheck FROM stats2 GROUP BY algo, input, prefix, rep, thread_count
            %% ) WHERE input="commoncrawl.txt" AND sacheck="ok" 
            %% AND (algo="Naiv" OR algo="MSufSort_ref" OR algo="mSufSort" OR algo="mSufSort_scan" OR algo="mSufSortV2")
            %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
            \addplot coordinates { (1,0.735833) (2,1.58136) (4,3.33698) };
            \addlegendentry{algo=MSufSort\_ref};
            \addplot coordinates { (1,7.14036) (2,11.1576) (4,26.7019) (8,62.0508) };
            \addlegendentry{algo=Naiv};
            \addplot coordinates { (1,2.86381) (2,6.23416) (4,12.5015) (8,26.8698) (12,51.5676) (16,69.5556) };
            \addlegendentry{algo=mSufSort};
            \addplot coordinates { (1,2.85214) (2,6.1803) (4,12.3844) (8,26.6715) (12,51.2229) (16,69.8373) };
            \addlegendentry{algo=mSufSortV2};
            \addplot coordinates { (1,5.50892) (2,11.4199) (4,20.11) (8,38.7854) (12,68.3685) };
            \addlegendentry{algo=mSufSort\_scan};

        \end{axis}
        \begin{axis}[
                cycle list name={exoticlines},
                at={(axis1.outer north east)},
                anchor=outer north west,
                name=axis2,
                width=0.5\textwidth,
                height=65mm,
                title={commoncrawl.txt},
                xlabel={input size [200\,MB]},
                ylabel={Extra Memory [GiB]},
            ]

            %% MULTIPLOT(algo) SELECT thread_count AS x, memPeak/1024/1024/1024 AS y, MULTIPLOT
            %% FROM (
            %% SELECT algo, input, MEDIAN(memFinal) AS memFinal, MEDIAN(memOff) AS memOff, AVG(memPeak) AS memPeak, prefix, rep, thread_count, MEDIAN(time) AS time, sacheck FROM stats2 GROUP BY algo, input, prefix, rep, thread_count
            %% ) WHERE input="commoncrawl.txt" AND sacheck="ok" 
            %% AND (algo="Naiv" OR algo="MSufSort_ref" OR algo="mSufSort" OR algo="mSufSort_scan" OR algo="mSufSortV2")
            %% GROUP BY MULTIPLOT,x ORDER BY MULTIPLOT,x
            \addplot coordinates { (1,0.792106) (2,1.57336) (4,3.15495) };
            \addlegendentry{algo=MSufSort\_ref};
            \addplot coordinates { (1,0.0) (2,0.0) (4,0.0) (8,0.0) };
            \addlegendentry{algo=Naiv};
            \addplot coordinates { (1,0.202018) (2,0.408039) (4,0.81636) (8,1.63092) (12,3.88998) (16,6.51905) };
            \addlegendentry{algo=mSufSort};
            \addplot coordinates { (1,0.202022) (2,0.408043) (4,0.816364) (8,1.63093) (12,3.89001) (16,6.51911) };
            \addlegendentry{algo=mSufSortV2};
            \addplot coordinates { (1,0.0238568) (2,0.0473121) (4,0.0941944) (8,0.187944) (12,0.375891) };
            \addlegendentry{algo=mSufSort\_scan};

            \legend{}
        \end{axis}
    \end{tikzpicture}

    \medskip
    \ref{legend-seq-msufsort-2}
\end{figure}
\FloatBarrier

Es wurden alle drei sequentiellen Varianten des MSufSort parallelisiert.
In \todo{Fix these legends wtf} den Experimenten \ref{legend-seq-msufsort-0}, \ref{legend-seq-msufsort-1} und \ref{legend-seq-msufsort-2} ist jeweils der naive Algorithmus am langsamsten, was bedeutet,
dass zumindest alle Varianten benutzbar sind. In \ref{legend-seq-msufsort-0} und \ref{legend-seq-msufsort-1} ist die Scan-Variante am schnellsten,
insbesondere bei dem DNA Eingabetext erkennt man auch eine deutlich flacher verlaufende Kurve,
vermutlich durch die lineare Laufzeit in einem der Sortierer.
Dieser (Scan-)Sortierer profitiert auch insbesondere von sehr kleinen Alphabeten,
da dann weniger Cache-Misses auftreten. Die beiden anderen Varianten unterscheiden sich fast gar nicht.
In \ref{legend-seq-msufsort-2} liegt die Scan-Variante oberhalb versetzt zu den anderen Varianten,
skaliert aber zumindest nicht schlechter und liegt näher an den normalen MSufSort Varianten als am naiven Sortierer.
