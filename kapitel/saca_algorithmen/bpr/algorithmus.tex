\subsection{Algorithmus}
\label{bpr:algorithmus}

Nachdem in Kapitel \ref{bpr:vorueberlegungen} bereits die formalen Grundlagen für die Beschreibung des \bpr-Algorithmus geschaffen wurden, können wir nun präziser auf die Funktionsweise des Algorithmus eingehen. Die Basis für das Verfahren bildet die Nutzung von Abhängigkeiten zwischen mehreren Suffixen: Teilen sich zwei Suffixe \suffix{i} und \suffix{j} einen gemeinsamen Präfix der Länge \(\textit{offset}\), so ist zunächst festzustellen, dass \suffix{i+\textit{offset}} bzw. \suffix{j+\textit{offset}} nicht nur Suffixe von \inputtext, sondern auch Suffixe von \suffix{i} bzw. \suffix{j}  sind. Die Reihenfolge von \suffix{i} und \suffix{j} im Suffix-Array kann also einfach durch die Reihenfolge der eventuell bereits zuvor sortierten Suffixe \suffix{i+\textit{offset}} und \suffix{j+\textit{offset}} bestimmt werden. Um allerdings auf eine derartige Vorsortierung zurückgreifen zu können, muss zu Beginn zumindest eine grobe \glqq initiale Sortierung\grqq{} der Suffixe existieren.\par\smallskip
Um dies zu erreichen, verwendet der hier beschriebene Algorithmus zwei Phasen, von denen die erste dazu dient, die Suffixe initial nach gemeinsamen Präfixen der Länge \(d\) zu gruppieren. Auf Basis dieser Gruppierung werden die Suffixe Buckets zugewiesen, sodass sich zwei Suffixe genau dann im gleichen Bucket befinden, wenn sie einen gemeinsamen Präfix der Länge \(d\) besitzen.\par
In der zweiten Phase werden dann die Buckets anhand der oben genannten Vorschrift schrittweise rekursiv verfeinert. Auf diese Weise ergibt sich das fertig sortierte Suffix-Array, sobald jeder Bucket eine minimale Länge von 1 erreicht hat.\par\smallskip
Im Folgenden werden beide Phasen im Detail erklärt. Wir verwenden dafür als Beispiel das Fantasiewort \covfefefe, dessen Suffixe wir mittels \bpr sortieren.

\input{kapitel/saca_algorithmen/bpr/algorithmus/phase1}
\input{kapitel/saca_algorithmen/bpr/algorithmus/phase2}
\input{kapitel/saca_algorithmen/bpr/algorithmus/beispiel}
